<!-- Generated by Harlequin WebMaker 2.3.1 (16-Oct-1996)Macintosh Common Lisp Version 4.0 --><HTML> <HEAD><TITLE>Gestalt</TITLE></HEAD><BODY><A NAME=HEADING426></A><CENTER>     <IMG BORDER="0" SRC="../../../../images/level3.gif" ALT="Title Banner"      ISMAP USEMAP="#level3">     <BR>     <MAP NAME="level3">     <!-- Find It -->     <AREA SHAPE="RECT" COORDS="7, 9, 69, 30" HREF="../../../../find.html">     <!-- Main -->     <AREA SHAPE="RECT" COORDS="432, 9, 492, 30" HREF="../../../../devworld.shtml">     </MAP><P><A HREF="NPG2-425.html"><IMG ALIGN = BOTTOM SRC = "graphics/prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="NPG2-2.html"><IMG ALIGN = BOTTOM SRC = "graphics/content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="NPG2-443.html"><IMG ALIGN = BOTTOM SRC = "graphics/index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="NPG2-427.html"><IMG ALIGN = BOTTOM SRC = "graphics/next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P><FONT SIZE=-1><DL><DT><A HREF="../../techinfo.html"><B>Newton Developer Technical Information:</B></A> <A HREF="NPG2-2.html"><B>Newton Programmer's Guide: 2.1 OS Addendum</B></A> / <BR><DD><A HREF="NPG2-372.html"><B>Chapter 11 - Miscellaneous</B></A> / <A HREF="NPG2-373.html"><B>Reference</B></A><BR><DL><DD><A HREF="NPG2-388.html"><B>Functions and Methods</B></A> / <A HREF="NPG2-419.html"><B>Utility Functions</B></A></DL></DL></FONT><P><HR><BLOCKQUOTE><A NAME=HEADING426-0></A><H3><A NAME=MARKER-9-137></A><A NAME=MARKER-24-138></A>Gestalt</H3><CODE>Gestalt(<I>selector</I>)</CODE><P> Returns information about the Newton system; the type of information returned depends on the value of the <I>selector</I> parameter.<P><DL><DT><I><I>selector</I></I><DD> A constant that specifies the type of information that is returned on the system. The following values are currently allowed: <CODE>kGestalt_SystemInfo</CODE>, <CODE>kGestalt_Backlight</CODE>, <CODE>kGestaltArg_HasSoftContrast</CODE>, and <CODE>kGestaltArg_VolumeInfo</CODE>.<P><DT><I>return value</I><DD> Depends on <I>selector</I>, see DISCUSSION.<P></DL><B>DISCUSSION</B><P> The return value of this function depends on the value of <I>selector</I>, as follows:<P><UL><LI>If <I>selector</I> is <CODE>kGestalt_SystemInfo</CODE>, <A HREF=#MARKER-9-137><EM>*</EM></A><CODE>Gestalt</CODE> returns a frame with the following slots:</UL><B>Slot Descriptions</B><P><DL><DT><CODE>manufacturer</CODE><DD>  An integer indicating the manufacturer of the Newton Device. <DT><CODE>machineType</CODE><DD> An integer indicating the hardware type this ROM was built for. <DT><CODE>ROMStage</CODE><DD> A decimal integer indicating the language (English, German, French) and the stage of the ROM (alpha, beta, final).<DT><CODE>ROMVersion</CODE><DD> A packed integer indicating the major and minor ROM version numbers. You can use the following function to convert this number into an array, containing an integer for the ROM major and minor version numbers:</DL><PRE><P> func (ROMVersionInteger)<P>begin        local minor := BAND(ROMVersionInteger, 0xFFFF);        local major := BAND(ROMVersionInteger&gt;&gt;16, 0xFFFF);        [ Floor(StringToNumber(BAND(major&gt;&gt;12, 0xF)                                 &amp; BAND(major&gt;&gt;8, 0xF)                                 &amp; BAND(major&gt;&gt;4, 0xF)                                 &amp; BAND(major, 0xF))),        Floor(StringToNumber(BAND(minor&gt;&gt;12, 0xF)                                 &amp; BAND(minor&gt;&gt;8, 0xF)                                 &amp; BAND(minor&gt;&gt;4, 0xF)                                 &amp; BAND(minor, 0xF)))] end<P><P></PRE><DL><DT><DD> Here is another example of code to test if your Newton is running 2.x. The following expression evaluates to a non-<CODE>nil</CODE> value if the major version is 2:<DT><CODE>BAND((<A HREF=#MARKER-9-137><EM>*</A>Gestalt(kGestalt_SystemInfo).ROMVersion)&gt;&gt;16, 0xFFFF) = 0x0002</EM></CODE><DD><DT><B><IMPORTANT>IMPORTANT<EM></EM></B><DD>Do not assume that if the Newton is running version 2.0 or later that a particular feature exists. You still need to test the Newton to make sure the feature exists.  <EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif"><DT><B>Note</B><DD>The <CODE>machineType</CODE>, <CODE>ROMStage</CODE> and <CODE>ROMVersion</CODE> slots provide internal configuration information and should not be relied on. <EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif"><DT><CODE><A NAME=MARKER-10-139></A>screenWidth</CODE><DD> An integer representing the width of the screen in pixels. The width takes into account the current screen orientation.<DT><DD> For example, on the MessagePad 120, because the screen width is 240 and the screen height is 320, in portrait orientation <A HREF=#MARKER-9-137><EM>*</EM></A><CODE>Gestalt</CODE> returns a width of 240. If the screen is rotated, <A HREF=#MARKER-9-137><EM>*</EM></A><CODE>Gestalt</CODE> returns a width of 320.<DT><CODE>screenHeight</CODE><DD>  An integer representing the height of the screen in pixels.<DT><CODE>screenResolutionX</CODE><DD> An integer representing the number of horizontal pixels per inch. For screens with square pixels, <CODE>screenResolutionX</CODE> equals <CODE>screenResolutionY</CODE>. On the MessagePad 120, for example, both <CODE>screenResolutionX</CODE> and <CODE>screenResolutionY</CODE> equal 85.<DT><CODE>screenResolutionY</CODE><DD> An integer representing the number of vertical pixels per inch.<DT><CODE>screenDepth</CODE><DD> The bit depth of the LCD screen. For the MessagePad 120, the LCD supports a monochrome screen depth of 1. The eMate 300 and MessagePad 200 have 4 bit depth LCD screens.<DT><CODE>patchVersion</CODE><DD> Returns 0 on an unpatched Newton and nonzero on a patched Newton.<DT><CODE><A NAME=MARKER-10-140></A>ROMVersionString</CODE><DD> The user-visible string that identifies the version of the installed ROM and the installed patch, if any.<DT><DD> The first part of the string is a "functionality level" indicating the OS version, such as 1.3, 2.0 or 2.1. <DT><DD> The second part of the string is a six-digit number in parentheses that is an encoded representation of ROM and system update information. <DT><CODE>cpuType</CODE><DD> A symbol specifying the type of CPU, possible values are '<CODE>strongArm</CODE>, <CODE>'arm710a</CODE>, and <CODE>'arm610a</CODE>.<DT><CODE>cpuSpeed</CODE><DD> A real indicating the speed of the CPU in megahertz.</DL><UL><LI>If <I>selector</I> is <CODE>kGestalt_Backlight</CODE>, <A HREF=#MARKER-9-137><EM>*</EM></A><CODE>Gestalt</CODE> returns either <CODE>nil</CODE>, indicating the unit does not have backlight hardware, or a one element array. If an array is returned the unique element contains either <CODE>nil</CODE> or a non-<CODE>nil</CODE> value, indicating whether backlight hardware is present.The following code correctly tests if a unit has a backlight:<P></UL><PRE><P>    local result := Gestalt(kGestalt_Backlight);<P>   if result and result[0] then // unit has backlightingelse        // unit does not have backlighting <P><P></PRE><UL><LI>If <I>selector</I> is <CODE>kGestaltArg_HasSoftContrast</CODE>, <A HREF=#MARKER-9-137><EM>*</EM></A><CODE>Gestalt</CODE> returns either <CODE>nil</CODE>, or a 3 element array of the following form:<CODE>[<I>hasSoftContrast,</I></CODE> <I>minContrast<CODE>,</CODE></I> <I>maxContrast<CODE>]</CODE></I><P></UL><B>Array Element Descriptions</B><P><DL><DT><I><I>hasSoftContrast</I></I><DD> <CODE>True</CODE> or <CODE>nil</CODE> depending on whether there is a soft contrast control.<P><DT><I><I>minContrast</I></I><DD> Integer for the minimum contrast.<P><DT><I><I>maxContrast</I></I><DD> Integer for the maximum contrast.<P>You can use the values returned by this selector to set the <CODE>LCDContrast</CODE> user configuration variable.<P></DL><UL><LI>If <I>selector</I> is <CODE>kGestaltArg_VolumeInfo</CODE>, <A HREF=#MARKER-9-137><EM>*</EM></A><CODE>Gestalt</CODE> returns either <CODE>nil</CODE>, or a 7 element array of the following form:<CODE>[<I>hasInput,</I></CODE> <I>hasOutput<CODE>,</CODE></I> <I>hardwareVolControl<CODE>,</CODE></I> <I>headphoneJack<CODE>,</CODE></I> <I>minAudibleDB<CODE>,</CODE></I> <I>numDVLevels<CODE>,</CODE></I> <I>devicesBitfield<CODE>]</CODE></I><P></UL><B>Array Element Descriptions</B><P><DL><DT><I>hasInput</I><DD> <CODE>True</CODE> or <CODE>nil</CODE> depending on whether the device can support sound input.<DT><I>hasOutput</I><DD> <CODE>True</CODE> or <CODE>nil</CODE> depending on whether the device can support sound output.<DT><I>hardwareVolControl</I><DD> <CODE>True</CODE> or <CODE>nil</CODE> depending on whether the device has a hardware volume control.<DT><I>headphoneJack</I><DD> <CODE>True</CODE> or <CODE>nil</CODE> depending on whether the device has a built-in headphone jack.<DT><I>minAudibleDB</I><DD> An integer, the minimal decibel level for output. The MessagePad 2000 is set to -31.9760. <DT><I>numDVLevels</I><DD> An integer, the number of levels between <I>minAudibleDB</I> and 0. The dB increment per level is <I>minAudibleDB<CODE>/numDVLevels. </CODE></I>The MessagePad 2000 is set to 14. <DT><I>devicesBitfield</I><DD> A packed integer with information about the built-in sound devices. This integer contains the summation of the applicable device constants. Device constants are described in <A HREF=NPG2-285.html#MARKER-9-129>&quot;Device Constants&quot;</A> in <A HREF=NPG2-262.html#MARKER-9-92>Chapter 7, "Sound."</A> The two important ones are <CODE>kInternalSpeaker</CODE> and <CODE>kInternalMic</CODE>.<DT><DD> The following function returns <CODE>nil</CODE> / non-<CODE>nil</CODE> if the current device has an internal microphone (use <CODE>kInternalSpeaker</CODE> to check for an internal speaker):</DL><PRE><P>    HasMic := func()<P>   begin      local volInfo := Gestalt(kGestaltArg_VolumeInfo) ;         return volInfo AND         (BAND(volInfo[6], kInternalMic) &lt;&gt; 0);    end<P><P></PRE><B>COMPATIBILITY</B><P> The <CODE>kGestalt_Backlight</CODE> and <CODE>kGestaltArg_VolumeInfo</CODE> selectors are not supported on 2.0 devices.<P></BLOCKQUOTE><HR><center><A HREF="NPG2-425.html"><IMG ALIGN = BOTTOM SRC = "graphics/prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="NPG2-2.html"><IMG ALIGN = BOTTOM SRC = "graphics/content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="NPG2-443.html"><IMG ALIGN = BOTTOM SRC = "graphics/index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="NPG2-427.html"><IMG ALIGN = BOTTOM SRC = "graphics/next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P><center><font size=-1><A HREF="NPG2-3.html">&copy; Apple Computer, Inc.</A><br>26 APR 1997<P><!--------------------------- Navigation Area ----------------------------------><BR><!-- Navigation Area --><BR><A HREF="reference to server cgi goes here"><IMG BORDER="0" SRC="../../../../images/nav.gif" WIDTH="500" HEIGHT="32" ALT="Navigation graphic, see text links" ISMAP USEMAP="#nav"></A><BR><P><A HREF="../../../../devworld.shtml">Main</A> | <A HREF="../../techinfo.html">Top of Section</A> | <A HREF="../../newtondev.shtml#WhatsNew">What's New</A> | <A HREF="http://www.apple.com/">Apple Computer, Inc.</A> |<A HREF="../../../../find.html">Find It</A> | <A HREF="../../feedback.html">Feedback</A> | <A HREF="../../../../help.html">Help</A></FONT><P></CENTER><!-- Don't forget to add the necessary links for each of these items. --><BR><MAP NAME="nav"><!-- client side map for www.apple.com nav.gif --><!-- Main --><AREA SHAPE="RECT" COORDS="9,6,70,25" HREF="../../../../devworld.shtml"><!-- Page One --><AREA SHAPE="RECT" COORDS="80,6,142,25" HREF="../../techinfo.html"><!-- What's New --><AREA SHAPE="RECT" COORDS="150,5,211,25" HREF="../../newtondev.shtml#WhatsNew"><!-- Apple Logo --><AREA SHAPE="RECT" COORDS="220,6,280,25" HREF="http://www.apple.com/"><!-- Find It --><AREA SHAPE="RECT" COORDS="290,5,350,26" HREF="../../../../find.html"><!-- Contact Us --><AREA SHAPE="RECT" COORDS="361,5,422,25" HREF="../../feedback.html"><!-- Help --><AREA SHAPE="RECT" COORDS="430,5,492,25" HREF="../../../../help.html"><!-- DEFAULT AREA NOT SUPPORTED BY CLIENT SIDE IMAGEMAPS! --></MAP><P></BODY></HTML> 