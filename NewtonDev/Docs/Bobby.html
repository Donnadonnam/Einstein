<!--This file created 8/27/97 2:45 PM by Claris Home Page version 2.0--><HTML><HEAD>   <TITLE>Bobby</TITLE>   <META NAME=GENERATOR CONTENT="Claris Home Page 2.0">   <X-SAS-WINDOW TOP=50 BOTTOM=765 LEFT=282 RIGHT=812></HEAD><BODY><H1><CENTER><FONT SIZE="+4" COLOR="#AF0000">Bobby User Guide</FONT></CENTER></H1><P>Bobby n. London Police would use lanterns during the night when onpatrol and inspection.</P><P><FONT COLOR="#000000">This application utilizes the LanternNewtAPIinterface. You must have Newton Devices installed along with a driverfor it to use. Bobby's primary user is Lantern device driverdevelopers. Bobby Enables developer to test various portions of theirdriver in isolation to an entire protocol stack. This is therecommended method for initially bringing up a new driver on theNewton platform.</FONT></P><P><FONT COLOR="#000000">This document assumes a familiarity with theprotoLanternClient API which is documented as part of the LanternDDK.</FONT></P><P><FONT SIZE="-1" COLOR="#AF0000">Note: Bobby does not guaranteestate of a protoLanternClient and the user is required to performsensible operations. eg. If you scrub a driver while you are attachedthen it is likely your system will require a reset.</FONT></P><P><FONT COLOR="#000000">This documentation follows the userinterface elements available on the screen.</FONT></P><UL>   <LI><FONT COLOR="#000000"><A HREF="#InformationButton">Information   Button</A></FONT>      <UL>      <LI><FONT COLOR="#000000"><A HREF="#About">About</A></FONT>            <LI><FONT COLOR="#000000"><A HREF="#Help">Help</A></FONT>            <LI><FONT COLOR="#000000"><A HREF="#Prefs">Prefs</A></FONT>            <LI><FONT COLOR="#000000"><A HREF="#Monitor">Monitor</A></FONT>      </UL>      <LI><FONT COLOR="#000000"><A HREF="#Connect">Connect</A></FONT>      <LI><FONT COLOR="#000000"><A HREF="#Send">Send</A></FONT>      <LI><FONT COLOR="#000000"><A HREF="#Event">Event</A></FONT>      <LI><FONT COLOR="#000000"><A HREF="#Register">Register</A></FONT>      <LI><FONT COLOR="#000000"><A HREF="#Minimize">Minimize</A></FONT>      <LI><FONT COLOR="#000000"><A HREF="#Client">"Client Name"   Picker</A></FONT>      <P><FONT COLOR="#000000"><A HREF="#Packet">Adding your own packet   definitions</A></FONT></P></UL><H2><FONT COLOR="#000000"><HR><A NAME="InformationButton"></A></FONT><FONTCOLOR="#0000AF">Information Button</FONT></H2><P>The Information button has four separate items you can choosefrom.</P><BLOCKQUOTE><H3><A NAME="About"></A>About</H3><P>This shows the about box for Bobby which contains the currentversion number.</P><H3><A NAME="Help"></A>Help</H3><P>This shows a view that contains information similar to that foundhere in this document. You can scroll in this view using the arrowson the side. This view can be minimized by tapping the<A HREF="#Minimize">Minimize</A> button.</P><H3><A NAME="Prefs"></A>Prefs</H3><P>The prefs view contains the current settings that Bobby uses.These settings can be changed at any time regardless of theconnection state. Prefs are removed when the Bobby package is removedso reloading Bobby or putting it on a memory card will cause a lossof preferences. Bobby also saves the last "<A HREF="#Client">ClientName</A>" that was used. This view can be minimized by tapping the<A HREF="#Minimize">Minimize</A> button.</P><BLOCKQUOTE><H4>Read Packet Data Checkbox</H4><P>When checked Bobby will automatically post a <B>'evReadBuffer</B>event to read the packet contents from the protoLanternClient when itreceives a <B>'evNewPacketReady</B> event.  Note that for this optionto have any effect you must be registered for receiving the<B>'evNewPacketReady</B> event (see<A HREF="#Register">Register</A>).</P><H4>Echo Packets Checkbox</H4><P>When checked Bobby automatically echoes any received packets bysending a <B>'evSendBuffer</B> event to the protoLanternClient. Notethat for this option to have any effect you must be registered forreceiving the <B>'evNewPacketReady</B> event (see<A HREF="#Register">Register</A>) and have the "Read Packet DataCheckbox" checked.</P><H4>Swap Src/Dst for Echo</H4><P>When checked Bobby will swap the ethernet source and destinationaddresses when echoing packets. This preference makes the assumptionthat the packet being received is an ethernet packet. Note that forthis option to have any effect you must be registered for receivingthe <B>'evNewPacketReady</B> event (see<A HREF="#Register">Register</A>) and have the "Read Packet DataCheckbox" checked as well as the "Echo Packets CheckBox" checked.</P><H4><A NAME="Increment"></A>Increment Packet Length Checkbox</H4><P>When checked Bobby it will incrementally add one byte of data tothe current packet being <A HREF="#Send">Sent</A>. ie. For sending 5packets sequentially where the first packet definition is of size 60bytes the next packet sent will be 61 bytes, the following 62 bytesand so on.</P><H4><A NAME="Interpacket"></A>"Interpacket Delay" Picker</H4><P>When sending out multiple packets with <A HREF="#Send">Send</A> itis possible to make Bobby add a time delay between sending eachpacket. This value defines the minimum amount of time for Bobby towait when sending multiple packets. Note that there will be someinherent delay due to the speed of NewtonScript execution.</P></BLOCKQUOTE><H3><A NAME="Monitor"></A>Monitor</H3><P>The monitor view shows information about the currentprotoLanternClient being used, and some of the current state of theLantern Driver Task.</P><BLOCKQUOTE><H4>"Update Every" Picker</H4><P>This picker specifies how often Bobby will reread the informationfrom the protoLanternClient.</P><H4>Device Address</H4><P>This is the address that is returned from sending the driver a<B>'evGetDeviceAddress</B> event. Not that this is not dynamicallyupdated and is read when the <B>Init</B> phase of<A HREF="#Connect">Connect</A> is made.</P><H4>Link Integrity</H4><P>The current state that the driver returns about the link whensending the <B>'evGetLinkIntegrity</B> event.</P><H4>Throughput (TX &amp; RX)</H4><P>The values the driver returns for Throughput when sending the<B>'evGetThroughput </B>event.</P><H4>State</H4><P>The current state returned by protoLanternClient:State().</P><H4>Packet Count</H4><P>Number of packets currently queued in the driver.</P><H4><B>Packet Buffer Count</B></H4><P>Current number of bytes in all of the queued packets.</P><H4>Packet Buffer Size</H4><P>Maximum number of queued bytes allowed before packets will bediscarded by the driver.</P><H4>Packet Valid Time</H4><P>Maximum time in ms that lantern will hold a packet in its queuewithout anyone reading it before it is discarded. Note that for thepacket to make it into the queue in the first place someone needed torequest the packet and each protoLanternClient accepts all packets.</P><H4>Rx Buffer Max</H4><P>Highest recorded "Packet Buffer Count".</P><H4>Rx Packets</H4><P>Number of packets received by the driver.</P><H4>Rx PacketSize</H4><P>Mean Received Packet Size</P><H4>Rx Dropped</H4><P>Number of packets dropped due to overflow</P><H4>Rx Aged</H4><P>Number of packets dropped as Valid Time expired</P><H4>Reset Picker</H4><P>This allows you to reset the Rx Statistics at any time. This willclear these statistics in Lantern and it will begin acquiring newvalues as soon as they are cleared.</P></BLOCKQUOTE></BLOCKQUOTE><H2><HR><A NAME="Connect"></A><FONT COLOR="#0000AF">Connect</FONT></H2><P>Connect allows for a connection to be made to different stateswith a protoLanternClient. This connection will be made using thecurrent <A HREF="#Client">"Client Name"</A> supplied. Most driverdevelopers will probably only need to use <B>proto_Inst_Init,proto_Inst_Init_Attach, Detach, Delete &amp; Detach_Delete.</B> Theother options are available for more internal testing but you may usethem if you wish.</P><P><FONT COLOR="#AF0000">Note that if you select_proto_Inst_Init_Attach twice Bobby will not automatically Detach andclean up the first protoLanternClient for you. Because this is notcleaned up you will need to reset to recover from this. ie. Try tomake sure you always clean up a connection by selecting Detach_Deletewhen done.</FONT></P><BLOCKQUOTE><H3>_proto</H3><P>Create a NewtonScript client memory object whose proto is aprotoLanternClient.</P><H3>Instantiate</H3><P>Instantiate the client using the current "Client Name".</P><H3>Init</H3><P>Init the client using the current "Client Name".</P><H3>Attach</H3><P>Attach the client.</P><H3>Detach</H3><P>Detach the client.</P><H3>Delete</H3><P>Delete the client and set it to nil. Note that if you do notDetach and simply Delete the protoLanternClient will clean up for youand call Detach automatically.</P><H3>_proto_Inst_Init</H3><P>Create client, Institate it &amp; Init it</P><H3>_proto_Ins_Init_Attach</H3><P>Create client, Institate, Init &amp; Attach</P><H3>Detach_Delete</H3><P>Detach and Delete and set client to nil</P></BLOCKQUOTE><H2><HR><A NAME="Send"></A><FONT COLOR="#0000AF">Send</FONT></H2><P>This is a plug-in type of interface. Bobby supplies two packetdefinitions for your use that you can extend (See<A HREF="#Packet">Adding Packet Definitions</A>).</P><P>Currently "AppleTalk" and "Ethernet" packet definitions areprovided.</P><BLOCKQUOTE><H3>Send button</H3><P>This will send the current packet definition contents via an<B>'evSendBuffer</B> event. You can select how many packets are to besent. Two preferences will affect the contents and how the packetsare sent; <A HREF="#Increment">Increment Packet Length</A> &amp;<A HREF="#Interpacket">Interpacket Delay</A>.</P></BLOCKQUOTE><H2><HR><A NAME="Event"></A><FONT COLOR="#0000AF">Event</FONT></H2><P>This allows you to send events to the driver. This supports fourevents; adding the AppleTalk multicast address and deleting theAppleTalk multicast address (0x090007ffffff); enabling and disablingpromiscuous mode. Promiscuous mode means that the hardware devicewill receive all ethernet packets, even those not directed at thedevices ethernet address, broadcast address or any multicastaddresses.</P><H2><HR><A NAME="Register"></A><FONT COLOR="#0000AF">Register</FONT></H2><P>This allows you to register for events received by the driver. Theevents for CardInserted and CardReady can be received with the driveronly "Inited".  Other events require the driver be "Attached".</P><H2><HR><FONT COLOR="#0000AF"><A NAME="Minimize"></A>Minimize</FONT></H2><P>The minimize button (<I>picture of a lantern</I>) will shrink anyview down to the bottom right side of the screen. The view may bereopened at any time by tapping on the inverse video name of theview. Note there is a known bug when shrinking the main view as someof its contents are not clipped, this is a problem with theprotoTXView that it uses and is unavoidable.</P><H2><HR><A NAME="Client"></A><FONT COLOR="#0000AF">"Client Name"Picker</FONT></H2><P>The client name is the name that was specified for the driver asthe protoLanternDriver DeviceCISProductName. This must match the CISProduct Name of the device and is used for establishing a<A HREF="#Connect">Connection</A>. Bobby remembers the last ClientName that was used and will default to this the next time it isopened.</P><H2><HR><A NAME="Packet"></A><FONT COLOR="#0000AF">Adding PacketDefinitions</FONT></H2><P><FONT COLOR="#000000">You can add your own packet definition toBobby for sending out specific data types for testing. Call theglobal function </FONT><B><FONTCOLOR="#000000">AddPacketDef</FONT></B><FONT COLOR="#000000"> to addthe packet definition to the list of packets that Bobby cansend.</FONT></P><P><B><FONTCOLOR="#000000">AddPacketDef(packetDefinition);</FONT></B></P><P><FONT COLOR="#000000">A sample packet definition that is includedwith Bobby is shown below that uses all the field typesallowed.</FONT></P><P><FONT COLOR="#000000">Note that when the packet view is firstopened the first field of each label line is set to the first optionwhich is assumed to be the default.</FONT></P><PRE><FONT COLOR="#000000">{ 		Name:	"AppleTalk",	Format:	[   '|Dest Address:ENET|,				'|Source Address:ENET|,				'|Length:ENET|,				'|802.2:ENET|,				'|SNAP:ENET|,				'|Payload:ENET| ],	Def:	[		{ 	sym:		'|Dest Address:ENET|,			label: 		"Dest Address",			maxSize:	6,			memory:		'DestAddress,			labelCommands:							[    "Ethernet Broadcast",								"AppleTalk Broadcast",							"Device Address" ],			labelData:	[     "FF FF FF FF FF FF", 							"09 00 07 FF FF FF",							'DeviceAddress ],		},		{ 	sym:		'|Source Address:ENET|,			label: 		"Source Address",			maxSize:	6,			memory:		'SourceAddress,			labelCommands:							[ "Device Address" ],			labelData:	[ 'DeviceAddress ],		},		{	sym:		'|Length:ENET|,			label:		"Length",			maxSize:	2,			labelCommands:	[ "Calculate It" ],			labelData:		[ 				{ 	type: 'Size, 					fields: [	'|802.2:ENET|, 								'|SNAP:ENET|, 								'|Payload:ENET|,							]				}			]		},		{	sym:		'|802.2:ENET|,			label:		"802.2",			maxSize:	3,			labelCommands:	[ "AppleTalk" ],			labelData:	[ "AA AA 03" ],		},		{	sym:		'|SNAP:ENET|,			label:		"SNAP",			maxSize:		5,			labelCommands:	[ "AARP", "AppleTalk" ],			labelData:	[ "00 00 00 80 F3", "08 00 07 80 9B" ]		},		{	sym:		'|Payload:ENET|,			label:		"Data",			maxSize:	2000,			lines:		5,			labelCommands:	[									"Random 50",								"Random 51",								"Random 100", 								"Random 500", 								"Random 1492", 								"Random 1493", 								"Random 2000", 								"Clear 50", 								"Clear 100", 								"Clear 500", 								"Clear 1492",								"Clear 1493",								"Clear 2000" ],			labelData: [				{ type: 'Random, size: 50 },				{ type: 'Random, size: 51 },				{ type: 'Random, size: 100 },				{ type: 'Random, size: 500 },				{ type: 'Random, size: 1492 },				{ type: 'Random, size: 1493 },				{ type: 'Random, size: 2000 },				{ type: 'Clear, size: 50 },				{ type: 'Clear, size: 100 },				{ type: 'Clear, size: 500 },				{ type: 'Clear, size: 1492 },				{ type: 'Clear, size: 1493 },				{ type: 'Clear, size: 2000 },			]		},	],},</FONT>&nbsp;</PRE></BODY></HTML>