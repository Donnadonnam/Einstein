<HTML><HEAD><TITLE>Newton 2.x Q&amp;A: Reading/Modifying Newton Works Data</TITLE></HEAD><BODY BGCOLOR="#FFFFFF"><CENTER><H2>Reading/Modifying Newton Works Data</H2><H4> One of the Newton 2.x OS Q&amp;As<BR>Copyright © 1997 Newton, Inc.  All Rights Reserved. Newton, Newton Technology, Newton Works, the Newton, Inc. logo, the Newton Technology logo, the Light Bulb logo and MessagePad are trademarks of Newton, Inc. and may be registered in the U.S.A. and other countries. Windows is a registered trademark of Microsoft Corp. All other trademarks and company names are the intellectual property of their respective owners.</H4><BR>For the most recent version of the Q&amp;As on the World Wide Web, check the URL: <CODE><A HREF="http://www.newton-inc.com/dev/techinfo/qa/qa.htm">http://www.newton-inc.com/dev/techinfo/qa/qa.htm</A></CODE><BR>If you've copied this file locally,<A HREF="qa.htm">click here to go to the main Newton Q&amp;A page.</A><BR>This document was exported on 7/23/97.</CENTER><H3><HR><B>NEW: </B>Reading/Modifying Newton Works Data  (5/15/97)</H3><DL><DD>Q:    How do I read/write information in Newton Works documents?<BR><BR>A:    The supported ability to read/write information from Newton Works documents depends on what type of stationery is used and what information is documented for that stationery type. For instance, word processor (paper) documents can be read and modified, whereas Draw documents can be read but not modified. If the desired Newton Works stationery is not built-in, contact the stationery's developer to determine whether reading and/or modifying the soup entry data is supported. <BR><BR>    Related APIs: To create new Newton Works documents, see the Q&amp;A"How  to Create Newton Works Documents". To modify data in Newton Works documents that are currently viewed, see the Newton 2.1 documentation for information about APIs to the word processor (Paper stationery) and the Draw application (Draw stationery) APIs for tools and stamps.<BR><BR>    For reading/writing information from "Paper" soup entries, see the format specified in the Q&amp;A"How  to Create Newton Works Documents" or the Newton 2.1 OS documentation.<BR><BR>    For "Draw" soup entries, we support creating new documents (see the Q&amp;A "How to Create Newton Works Documents") and reading shapes from documents that have been viewed in Newton Works already. However, there is no support for manipulating individual shapes of a current soup entry, nor examining shapes in items that have been created/imported, but never viewed in the Newton Works application.<BR><BR>    To read shape information from pictures, here is the information about how to extract shapes from valid Draw documents. <BR><BR>    The entry  has the basic Newton Works soup entry slots as shown below:<BR>        <CODE>class</CODE>:            Class of the item. For instance, for Draw documents, use the symbol <CODE>'drawPaper</CODE><BR>        <CODE>version</CODE>:        Integer, the current version of the entry<BR>        <CODE>title</CODE>:         String which is the document title<BR>        <CODE>timeStamp</CODE>:    Creation date of the entry<BR>        <CODE>realModTime</CODE>:    Date the entry was most recently modified<BR>    <BR>    The Draw document soup entry also has the slot called <CODE>saveData</CODE> that contains the following slots:<BR>        <CODE>shapes</CODE>:        This is an array of shapes in the document.<BR>        <CODE>styles</CODE>:        An array of all styles contained in the shapes array. <BR>        <CODE>selection</CODE>:    An array containing integer indexes into the shapes array, indicating the currently selected shapes.<BR><BR>    The <CODE>shapes</CODE> slot is represented as an array of style/shape pairs, as returned by <CODE>drawApp:GetContents()</CODE>. Each "shape" can be another array of shape and style pairs, representing grouping of shapes (these grouping can continue, so subarrays can have sub-subarrays, etc). If the shapes array contains exactly one item (its length is 1) and the class of the item is <CODE>'picture</CODE>, it is a picture that has been created/imported but not yet viewed in Newton Works. If this is the case, the individual shapes cannot be read, but the picture is the same format as the return value of the global function <CODE>MakePict</CODE>.<BR><BR>    Warning: Slots in the <CODE>saveData</CODE> slot of Draw documents already in Newton Works should be treated as read-only. Do not try to modify these data structures in any way. Manipulating them can result in serious user problems.</DL>