<HTML><HEAD><TITLE>Newton 2.x Q&amp;A: How to Create Newton Works Documents</TITLE></HEAD><BODY BGCOLOR="#FFFFFF"><CENTER><H2>How to Create Newton Works Documents</H2><H4> One of the Newton 2.x OS Q&amp;As<BR>Copyright © 1997 Newton, Inc.  All Rights Reserved. Newton, Newton Technology, Newton Works, the Newton, Inc. logo, the Newton Technology logo, the Light Bulb logo and MessagePad are trademarks of Newton, Inc. and may be registered in the U.S.A. and other countries. Windows is a registered trademark of Microsoft Corp. All other trademarks and company names are the intellectual property of their respective owners.</H4><BR>For the most recent version of the Q&amp;As on the World Wide Web, check the URL: <CODE><A HREF="http://www.newton-inc.com/dev/techinfo/qa/qa.htm">http://www.newton-inc.com/dev/techinfo/qa/qa.htm</A></CODE><BR>If you've copied this file locally,<A HREF="qa.htm">click here to go to the main Newton Q&amp;A page.</A><BR>This document was exported on 7/23/97.</CENTER><H3><HR><B>NEW: </B>How to Create Newton Works Documents  (5/15/97)</H3><DL><DD>Q:    How do I create a Newton Works document for Newton 2.1 OS devices or later?<BR><BR>A:    If you want to create a new "empty" stationery document, use the Newton Works method <CODE>AddEntryFromStationery</CODE>. For instance:<BR><CODE><PRE>    if GetRoot().NewtWorks then</PRE><BR>            GetRoot().NewtWorks:AddEntryFromStationery(stationerySym);</CODE><BR><BR>    If you want to create a new entry with data already in it, use the Newton Works method <CODE>AdoptEntryFromStationery</CODE>. To create a new entry, you must add the basic Newton Works soup entry slots and then any stationery-specific slots:<BR><BR>    (1) Create a frame with the basic Newton Works soup entry slots as shown below:<BR>        <CODE>class</CODE>:            Class of the item. For instance, for Draw documents, use the symbol <CODE>'drawPaper</CODE><BR>        <CODE>version</CODE>:        Integer, the current version of the entry<BR>        <CODE>title</CODE>:         String which is the document title<BR>        <CODE>timeStamp</CODE>:    Creation date of the entry<BR>        <CODE>realModTime</CODE>:    Date the entry was most recently modified<BR><BR>    (2) Add the stationery-specific slots:<BR><BR>    <B>"Draw" Stationery Additional Slots<BR></B><BR>    <CODE>saveData</CODE>: a frame with the following slots:<BR>        <CODE>shapes</CODE>:        Required. An array of a single item, a picture as returned by  the global function <CODE>MakePict</CODE>.<BR><CODE><PRE>    selection:    [], // the empty array    styles:        nil,</PRE><BR></CODE><BR>    Warning: the above information describes only how to create a new Draw document. See the Q&amp;A "Reading/Modifying Newton Works Data" for information on reading information from a Draw document. Slots in the <CODE>saveData</CODE> slot of Draw documents already in Newton Works should be treated as read-only. (Do not try to modify these data structures in any way.)<BR><BR><B>    "Paper" Stationery Additional Slots<BR></B><BR>    <CODE>SaveData</CODE>: the object returned from <CODE>protoTXView:Externalize().</CODE> See the Newton 2.1 OS documentation for information about <CODE>Externalize().</CODE>  Note that this data must be from a <CODE>protoTXView</CODE> that uses VBOs (it uses the <CODE>protoTXView:SetStore(...)</CODE> method), or Newton Works can run out of NewtonScript memory when editing the document.<BR><BR>    <CODE>hiliteRange</CODE>: frame with the document's hilite range (see the <CODE>protoTXView</CODE> documentation for details)<BR><BR>    <CODE>margins</CODE>: a frame with slots <CODE>'top</CODE>, <CODE>'left</CODE>, <CODE>'bottom</CODE>, <CODE>'right</CODE>, which are the document's margins in pixels. The frame can also optionally have the slots<CODE> 'userTop</CODE>, <CODE>'userLeft</CODE>, <CODE>'userBottom</CODE>, and <CODE>'userRight</CODE> that will contain numbers (integer or real) with the margin sizes translated to user units (inches or centimeters.)  If the <CODE>userXXX </CODE>slots are missing or <CODE>nil</CODE>, they will be calculated from the pixel values.<BR><BR><BR>    (3) Use code like the following to add the entry to the soup:<BR><CODE><PRE>    if GetRoot().NewtWorks then        GetRoot().NewtWorks:AdoptEntryFromStationery(theEntry, stationerySym, GetDefaultStore());</PRE><BR>    </CODE>    See the Newton Programmer's Reference for more info about the <CODE>NewtApplication:AdoptEntryFromStationery(...)</CODE> method.</DL>