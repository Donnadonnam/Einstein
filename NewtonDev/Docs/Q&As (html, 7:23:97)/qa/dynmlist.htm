<HTML><HEAD><TITLE>Newton 2.x Q&amp;A: Dynamically Adding to ProtoTextList Confuses Scrolling</TITLE></HEAD><BODY BGCOLOR="#FFFFFF"><CENTER><H2>Dynamically Adding to ProtoTextList Confuses Scrolling</H2><H4> One of the Newton 2.x OS Q&amp;As<BR>Copyright © 1997 Newton, Inc.  All Rights Reserved. Newton, Newton Technology, Newton Works, the Newton, Inc. logo, the Newton Technology logo, the Light Bulb logo and MessagePad are trademarks of Newton, Inc. and may be registered in the U.S.A. and other countries. Windows is a registered trademark of Microsoft Corp. All other trademarks and company names are the intellectual property of their respective owners.</H4><BR>For the most recent version of the Q&amp;As on the World Wide Web, check the URL: <CODE><A HREF="http://www.newton-inc.com/dev/techinfo/qa/qa.htm">http://www.newton-inc.com/dev/techinfo/qa/qa.htm</A></CODE><BR>If you've copied this file locally,<A HREF="qa.htm">click here to go to the main Newton Q&amp;A page.</A><BR>This document was exported on 7/23/97.</CENTER><H3><HR><B> </B>Dynamically Adding to ProtoTextList Confuses Scrolling  (1/15/97)</H3><DL><DD>Q:    I am adding items to a <CODE>protoTextList</CODE> after it is displayed. I add an item and scroll to highlight that item. However, the state of the scroll arrows does not correctly get updated. Sometimes it will indicate that there are more items to scroll when it is really at the end of the list.<BR><BR>A:    There is a problem with Newton 2.0 OS devices (although not Newton 2.1 OS devices) that causes the <CODE>protoTextList</CODE> to reset the scroll distance when you update the listItems array. The workaround is to always scroll the list to the top before calling <CODE>SetupList</CODE> when you add items. Then you can scroll the list to where you want it. Note that this workaround is safe to use in Newton 2.1 OS as well. In other words, if you are adding items to a <CODE>protoTextList</CODE>, use this workaround unless your application is Newton 2.1 OS-specific. This method will add a single item to the <CODE>protoTextList</CODE>, set the highlighted item to the new item and scroll if required. It will also make sure the item is unique.<BR><BR><CODE><PRE>    AddListItem := func(newItem)    begin         // Insert the item if not already in Array        local index := BInsert(listItems, item, '|str&lt;|, nil, true);        // item must be in the array and index will point to the item.        if NOT index then        begin            :Notify(kNotifyAlert, kAppName, "Duplicate entry.");            return nil;        end;        // workaround a bug in 2.0 that causes the        // scroll arrows to get out of sync        // do this by scrolling to the top        :DoScrollScript(-viewOriginY) ;        self:SetUpList();        // Setting the selection slot will highlight the item        selection := index;        // scroll to show the new item        if index &gt;= viewLines then            :DoScrollScript((index - viewLines + 1) * lineHeight) ;        self:RedoChildren();        return true;    end ;</CODE></PRE></DL>